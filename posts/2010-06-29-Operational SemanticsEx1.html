<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />

    <title>Jaiyalas' Note - Operational Semantics Ex1</title>
    <!--
    <link rel="stylesheet" type="text/css"
      href="http://netdna.bootstrapcdn.com/bootstrap/3.0.0/css/bootstrap.min.css" />
    <link rel="stylesheet" type="text/css" href="/css/default.css" />
    -->
    <link rel="stylesheet" type="text/css" href="http://netdna.bootstrapcdn.com/font-awesome/4.0.1/css/font-awesome.css" />
    <link rel="stylesheet" type="text/css" href="http://yui.yahooapis.com/pure/0.6.0/pure-min.css" />
    <link rel="stylesheet" type="text/css" href="../css/syntax.css" />
    <link rel="stylesheet" type="text/css" href="../css/blog.css" />
    <link rel="stylesheet" type="text/css" href="../css/side-menu.css" />
    
  </head>
  <body>

    <div id="layout">
      <!-- Menu toggle -->
      <a href="#menu" id="menuLink" class="menu-link">
	<!-- Hamburger icon -->
	<span></span>
      </a>
      <div id="menu">
        <div class="pure-menu">
          <a class="pure-menu-heading" href="#">Y.Y.-C.</a>
          <ul class="pure-menu-list">
	    <li class="pure-menu-item"><a href="../index.html" class="pure-menu-link">Home</a></li>
            <li class="pure-menu-item"><a href="../tags.html" class="pure-menu-link">Tags</a></li>
            <li class="pure-menu-item"><a href="../archive.html" class="pure-menu-link">Archive</a></li>
            <li class="pure-menu-item"><a href="../about.html" class="pure-menu-link">About</a></li>
          </ul>
        </div>
      </div> <!-- end menu -->
      <div id="main">
	<div class="content">
	  <div class="content">
  <!-- A wrapper for all the blog posts -->
  <div class="posts">
    <h1 class="content-subhead">Pinned Post</h1>
    <!-- A single blog post -->
    <section class="post">
      <header class="post-header">
	<h2 class="post-title">Operational Semantics Ex1</h2>
	<p class="post-meta">
	  
	  By <a href="#" class="post-author">Jaiyalas</a>
	  
	  under
	  <a class="post-category post-category-design" href="#">CSS</a>
	  <a class="post-category post-category-pure" href="#">Pure</a>
	</p>
	<p>
	  <small>Posted on June 29, 2010<a href="../posts/2010-06-29-Operational%20SemanticsEx1.html"><i class="fa fa-link fa-lg fa-fw"></i></a></small>
	</p>
      </header>
      <div class="post-description">
	<p><p>今天講了一點基本的Operational Semantics的東西。出了一個簡單的Homework。反正不用交出去，OCaml也不熟，所以就用Haskell來玩一下看看。:)</p>
<pre class="sourceCode haskell"><code class="sourceCode haskell"><span class="kw">type</span> <span class="dt">Number</span> <span class="fu">=</span> <span class="dt">String</span>
<span class="kw">type</span> <span class="dt">Variable</span> <span class="fu">=</span> <span class="dt">Strings</span>
<span class="kw">data</span> <span class="dt">AExp</span> <span class="fu">=</span> <span class="dt">Num</span> <span class="dt">Number</span>
          <span class="fu">|</span> <span class="dt">Var</span> <span class="dt">Variable</span>
          <span class="fu">|</span> <span class="dt">Add</span> <span class="dt">AExp</span> <span class="dt">AExp</span>
          <span class="fu">|</span> <span class="dt">Mult</span> <span class="dt">AExp</span> <span class="dt">AExp</span>
          <span class="fu">|</span> <span class="dt">Sub</span> <span class="dt">AExp</span> <span class="dt">AExp</span>
          <span class="kw">deriving</span> (<span class="dt">Show</span>)

<span class="kw">data</span> <span class="dt">BExp</span> <span class="fu">=</span> <span class="dt">T</span>
          <span class="fu">|</span> <span class="dt">F</span>
          <span class="fu">|</span> <span class="dt">Eq</span> <span class="dt">AExp</span> <span class="dt">AExp</span>
          <span class="fu">|</span> <span class="dt">LeEq</span> <span class="dt">AExp</span> <span class="dt">AExp</span>
          <span class="fu">|</span> <span class="dt">Not</span> <span class="dt">BExp</span>
          <span class="fu">|</span> <span class="dt">Conj</span> <span class="dt">BExp</span> <span class="dt">BExp</span>
          <span class="kw">deriving</span> (<span class="dt">Show</span>)
          
<span class="kw">data</span> <span class="dt">Stm</span> <span class="fu">=</span> <span class="dt">Ass</span> <span class="dt">Variable</span> <span class="dt">AExp</span>
         <span class="fu">|</span> <span class="dt">Skip</span>
         <span class="fu">|</span> <span class="dt">Seq</span> <span class="dt">Stm</span> <span class="dt">Stm</span>
         <span class="fu">|</span> <span class="dt">If</span> <span class="dt">BExp</span> <span class="dt">Stm</span> <span class="dt">Stm</span>
         <span class="fu">|</span> <span class="dt">While</span> <span class="dt">BExp</span> <span class="dt">Stm</span>
         <span class="fu">|</span> <span class="dt">Repeat</span> <span class="dt">Stm</span> <span class="dt">BExp</span>
         <span class="kw">deriving</span> (<span class="dt">Show</span>)
         
<span class="kw">type</span> <span class="dt">State</span> <span class="fu">=</span> <span class="dt">Variable</span> <span class="ot">-&gt;</span> <span class="dt">Int</span>

<span class="ot">n ::</span> <span class="dt">Number</span> <span class="ot">-&gt;</span> <span class="dt">Int</span>
n m <span class="fu">=</span> (read m)<span class="ot"> ::</span> <span class="dt">Int</span>

<span class="ot">a ::</span> <span class="dt">AExp</span> <span class="ot">-&gt;</span> <span class="dt">State</span> <span class="ot">-&gt;</span> <span class="dt">Int</span>
a e s  <span class="fu">=</span> <span class="kw">case</span> e <span class="kw">of</span> 
  <span class="dt">Num</span> m <span class="ot">-&gt;</span> n m
  <span class="dt">Var</span> x <span class="ot">-&gt;</span> s x
  <span class="dt">Add</span> e1 e2 <span class="ot">-&gt;</span> (a e1 s) <span class="fu">+</span> (a e2 s)
  <span class="dt">Mult</span> e1 e2 <span class="ot">-&gt;</span> (a e1 s) <span class="fu">*</span> (a e2 s)
  <span class="dt">Sub</span> e1 e2 <span class="ot">-&gt;</span> (a e1 s) <span class="fu">-</span> (a e2 s)

<span class="ot">b ::</span> <span class="dt">BExp</span> <span class="ot">-&gt;</span> <span class="dt">State</span> <span class="ot">-&gt;</span> <span class="dt">Bool</span>
b e s  <span class="fu">=</span> <span class="kw">case</span> e <span class="kw">of</span>
  <span class="dt">T</span>          <span class="ot">-&gt;</span> <span class="dt">True</span>
  <span class="dt">F</span>          <span class="ot">-&gt;</span> <span class="dt">False</span>
  <span class="dt">Eq</span> e1 e2   <span class="ot">-&gt;</span> (a e1 s) <span class="fu">==</span> (a e2 s)
  <span class="dt">LeEq</span> e1 e2 <span class="ot">-&gt;</span> (a e1 s) <span class="fu">&amp;</span>lt;<span class="fu">=</span> (a e2 s)
  <span class="dt">Not</span> bexp   <span class="ot">-&gt;</span> not (b bexp s)
  <span class="dt">Conj</span> b1 b2 <span class="ot">-&gt;</span> (b b1 s) <span class="fu">&amp;</span>amp;<span class="fu">&amp;</span>amp; (b b2 s)

<span class="kw">data</span> <span class="dt">Configure</span> <span class="fu">=</span> <span class="dt">Inter</span> <span class="dt">Stm</span> <span class="dt">State</span>
               <span class="fu">|</span> <span class="dt">Final</span> <span class="dt">State</span>
               

<span class="ot">update ::</span> <span class="dt">Variable</span> <span class="ot">-&gt;</span> <span class="dt">AExp</span> <span class="ot">-&gt;</span> <span class="dt">State</span> <span class="ot">-&gt;</span> <span class="dt">State</span>
update x e s y <span class="fu">=</span> <span class="kw">if</span> (x<span class="fu">==</span>y) 
  <span class="kw">then</span> a e s 
  <span class="kw">else</span> s y

<span class="ot">ns ::</span> <span class="dt">Configure</span> <span class="ot">-&gt;</span> <span class="dt">Configure</span>
ns c <span class="fu">=</span> <span class="kw">case</span> c <span class="kw">of</span>
  (<span class="dt">Inter</span> (<span class="dt">Ass</span> v e) s)     <span class="ot">-&gt;</span> <span class="dt">Final</span> (update v e s)
  (<span class="dt">Inter</span> (<span class="dt">Skip</span>) s)        <span class="ot">-&gt;</span> <span class="dt">Final</span> s
  (<span class="dt">Inter</span> (<span class="dt">Seq</span> st1 st2) s) <span class="ot">-&gt;</span> <span class="kw">let</span> (<span class="dt">Final</span> s') <span class="fu">=</span> ns (<span class="dt">Inter</span> st1 s) <span class="kw">in</span> ns (<span class="dt">Inter</span> st2 s')
  (<span class="dt">Inter</span> (<span class="dt">If</span> bexp st1 st2) s) <span class="ot">-&gt;</span> <span class="kw">if</span> (b bexp s) 
    <span class="kw">then</span> ns (<span class="dt">Inter</span> st1 s)
    <span class="kw">else</span> ns (<span class="dt">Inter</span> st2 s)
  (<span class="dt">Inter</span> (<span class="dt">While</span> bexp st) s)   <span class="ot">-&gt;</span> <span class="kw">if</span> (b bexp s) 
    <span class="kw">then</span> ns (<span class="dt">Inter</span> st s)
    <span class="kw">else</span> (<span class="dt">Final</span> s)
  (<span class="dt">Inter</span> (<span class="dt">Repeat</span> st bexp) s)  <span class="ot">-&gt;</span> <span class="kw">let</span> (<span class="dt">Final</span> s') <span class="fu">=</span> ns (<span class="dt">Inter</span> st s) <span class="kw">in</span>
    <span class="kw">if</span> (b bexp s') 
      <span class="kw">then</span> ns (<span class="dt">Inter</span> (<span class="dt">Repeat</span> st bexp) s')
      <span class="kw">else</span> <span class="dt">Final</span> s'

default_state x <span class="fu">=</span> error <span class="st">&quot;NotFound&quot;</span>

x1_state <span class="fu">=</span> update <span class="st">&quot;x&quot;</span> (<span class="dt">Num</span> <span class="st">&quot;1&quot;</span>) default_state

test1 <span class="fu">=</span> <span class="dt">Seq</span> <span class="dt">Skip</span> (<span class="dt">Ass</span> <span class="st">&quot;x&quot;</span> (<span class="dt">Num</span> <span class="st">&quot;5&quot;</span>))

new_state <span class="fu">=</span> <span class="kw">let</span> (<span class="dt">Final</span> sFun) <span class="fu">=</span> ns (<span class="dt">Inter</span> test1 x1_state) <span class="kw">in</span> sFun <span class="st">&quot;x&quot;</span></code></pre></p>
	<p>[Tags: <a href="../tags/haskell.html">haskell</a>, <a href="../tags/operational%20semantics.html">operational semantics</a>]</p>
      </div>
    </section>
  </div> <!-- end posts -->
            




	  <div class="footer">
	    Powered by <a href="http://jaspervdj.be/hakyll">Hakyll</a>
	  </div> <!-- end footer-->
	</div> <!-- end content -->
      </div> <!-- end main -->
    </div> <!-- end layout -->
    
    <script src="../resources/ui.js"></script>
  </body>
</html>
